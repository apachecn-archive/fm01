<!-- lang: zh_CN -->
<!-- fm01/doc/ -->

# fm01/doc
<https://github.com/sceext2/fm01/tree/main/doc>

胖蚊子 (Fat Mosquito) 系列文档.

胖蚊子系列起源于胖蚊子 1 号 (FM01) 小飞机, 但在制造小飞机的过程中,
相关技术产生了更多项目.
现将所有项目统称为胖蚊子系列, 并将相关文档集中于 `fm01/doc`.

注: 目前大部分这些项目都处于起步阶段.


## 胖蚊子系列廉价 4 旋翼小飞机

设计中的机型:

| 序号 | 机型 | 说明 | 整机成本 (CNY) | 备注 |
| :--: | :-- | :--- | ------------: | :--- |
| 1 | 胖蚊子 1 号 (FM01) | 600 克重型 3 寸, 胖蚊子飞控, 胖蚊子电调, 机载手机 | 340 | |
| 2 | 胖蚊子 2 号 (FM02) | 廉价 2 寸空心杯, PCB 机架, esp32-cam | 60 | |
| 3 | 胖蚊子 2i (FM02i) | 超廉价红外遥控夜间空心杯小飞机 | 35 | |

计划中 (尚未开始设计) 的机型:

| 序号 | 机型 | 说明 | 整机成本 (CNY) | 备注 |
| :--: | :-- | :--- | ------------: | :--- |
| 1 | 胖蚊子 2b (FM02b) | 在 2 号基础上引入树莓派 zero w 摄像头 | 200 | |
| 2 | 胖蚊子 1c (FM01c) | 在 1 号基础上引入 2b 特性 (树莓派) | 490 | |
| 3 | 胖蚊子 3 号 (FM03) | 2 寸小无刷, 防水特性 | | |
| 4 | 胖蚊子 1r (FM01r) | 冗余机型, 单发失效模式, 飞控电调冗余 | |
| 5 | 胖蚊子 4 号 (FM04) | 双摄像头 3D 视觉 | | |

注: 成本仅供参考.


## 胖蚊子系列小项目

| 名称 | 说明 | 成本 (CNY) | 备注 |
| :-- | :--- | ---------: | :--- |
| 胖蚊子电调 (FMESC-1) | 4 路无刷无感电机驱动, 16V 40A | 50 | |
| 胖蚊子飞控 (FMFCS) | 用于胖蚊子系列小飞机 | | |
| 胖蚊子打印机 (fmprinter-1) | 简单的廉价小型打印机 | 30 | |

注: 成本仅供参考.


## 胖蚊子系列 PCB

胖蚊子系列使用的电路板.
详见 [kicad](./kicad) 目录.

| 序号 | 名称 | 说明 | 成本 (CNY) | 备注 |
| :--: | :-- | :--- | ---------: | :--- |
| 1 | `LQFP64-10x10mm-CLAMP` | LQFP64 芯片夹座, 用于免焊接烧录单片机 | 1 | 测试成功 |
| 2 | `FMESC-1-A`, FMESC-1-C, FMESC-1-B | 胖蚊子电调 (FMESC-1) 电路板 | | |
| 3 | FMSMD-1 | 步进电机驱动 (4 路), DRV8825 (2.5A, 8.2 ~ 45V, 32 细分) | | |
| 4 | FMSMD-2 | 步进电机驱动 (4 路), DRV8833 (1.5A, 2.7 ~ 10.8V) | | |
| 5 | FM02-B-1 | 胖蚊子 2 号 (FM02) 机架及主要电路板 | 10 | |

注: 成本仅供参考.


## 胖蚊子协议

胖蚊子系列使用的通信协议 (protocol).
详见 [fmp](./fmp) 目录.

| 名称 | 说明 | 备注 |
| :-- | :--- | :--- |
| fmp-uart | 胖蚊子串口协议 (数据链路层), 在 UART 的基础上进行简单封装 | |
| fmp-uart-fmesc | 胖蚊子串口协议 (应用层), 用于胖蚊子电调 (FMESC-1) | |
| fmp-uart-fmprinter | 胖蚊子串口协议 (应用层), 用于胖蚊子打印机 (fmprinter-1) | |
| fmp-ir-100k | 胖蚊子红外遥控协议 (数据链路层), 速率 100kbps | |
| fmp-ir-50k | 胖蚊子红外遥控协议 (数据链路层), 速率 50kbps | |
| fmp-ir-20k | 胖蚊子红外遥控协议 (数据链路层), 速率 20kbps | |
| fmp-ir-fm02 | 胖蚊子红外遥控协议 (应用层), 用于 fm02i 小飞机 | |
| fmp-usb | MCU 与上位机之间 (数据链路层), USB 接口 | |


## 胖蚊子系列软件库

胖蚊子系列是软硬件混合的项目, 硬件需要软件的驱动.
详见 [libfm-rs](./libfm-rs) 目录.

| 名称 | 说明 | 语言 | 运行环境 | 备注 |
| :-- | :--- | :--: | :------ | :--- |
| libfms.rs | 安全 (Security) 基础库, 提供 CRC, sha2, 数字签名等 | rust | arm, x86 | |
| libfmp.rs | 胖蚊子系列通信协议 (Fat Mosquito Protocol) 的实现和封装 | rust | arm, x86 | |
| libfmshal.rs | MCU 安全 HAL (Safe HAL), 包括内存安全, 并发安全等 | rust | stm32f0, stm32f1 | |
| libfmel.rs | MCU 事件驱动 (Event Loop) 框架 | rust | stm32f0, stm32f1 | |
| libfmhal.rs | MCU 硬件抽象 (Hardware Abstraction Layer) | rust | stm32f0, stm32f1 | |
| libfmesc.rs | 胖蚊子电调代码库 | rust | stm32f0, stm32f1 | |
| fmesc-1 | 胖蚊子电调 (FMESC-1) 固件 | rust | stm32f0, stm32f1 | |
| fmprinter-1 | 胖蚊子打印机 (fmprinter-1) 固件 | rust | stm32f0, stm32f1 | |
| fmprinter-ui | 胖蚊子打印机用户界面 | js (electron) | Linux, Android | |
| fmfc | 胖蚊子飞控 (机载部分) | rust, C | esp32, esp32s2, stm32f1 | |


## 胖蚊子系列设计原则

+ **廉价**.

  在设计性能可以接受的情况下 (不追求高性能), 尽可能使用廉价的设计与硬件选型, 避免使用昂贵的模块, 组件, 芯片, 元器件.
  追求胖蚊子系列整体的硬件低成本.
  避免因为过高的价格, 而阻止更多人尝试胖蚊子系列.

+ **原料易得**.

  胖蚊子系列的硬件模块, 组件, 元器件等的选型, 以及组装所需使用的各种工具, 应使用方便购买, 货源充足的.
  使用常见的标准, 接口.
  避免因为买不到相应的硬件材料, 而阻止更多人尝试胖蚊子系列.

+ **一致性**.

  胖蚊子系列尽可能共用同样的技术, 模块, 接口, 器件选型, 协议, 工具, 使用同样的设计风格.

+ **数字化与安全性**.

  在胖蚊子系列的各硬件模块之间, 各设备之间, 尽量使用数字通信协议, 不使用模拟通信协议.
  通信协议考虑加密, 完整性, 干扰等安全性因素.
  胖蚊子系列的软硬件设计, 考虑冗余, 模块故障或失效的处理, 应急策略等多种安全机制.
  尽可能避免或减少机器伤人.

  胖蚊子系列的软件部分, 尽可能避免或减少使用 C 语言.
  尽量使用 [rust](https://www.rust-lang.org/) 编程语言, 以提高软件部分的稳定性与安全性.

+ **开源**.

  胖蚊子系列的所有软件代码与硬件设计全部开源, 并尽可能丰富文档内容.
  以便更多人尝试胖蚊子系列.


## 相关代码库

TODO


## LICENSE

[`CC-BY-SA 4.0+`](https://creativecommons.org/licenses/by-sa/4.0/)
